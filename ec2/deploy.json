{
    "Description": "Create an EC2 instance running the Amazon Linux 32 bit AMI.",
    "Parameters": {
        "KeyPair": {
            "Description": "The EC2 Key Pair to allow SSH access to the instance",
            "Type": "String",
            "Default": {
                "Ref": "KeyPair"
            }
        }
    },
    "Resources": {
        "MyIamInstanceProfile": {
            "Type": "AWS::IAM::InstanceProfile",
            "Properties": {
                "InstanceProfileName": "MyIamInstanceProfile",
                "Path": "/",
                "Roles": [
                    "MyAdminRole"
                ],
                "Tags": [
                    {
                        "created_timestamp": 1646301344,
                        "last_modified_timestamp": 1646301466,
                        "resource_name": "MyIamInstanceProfile",
                        "resource_type": "AWS::IAM::InstanceProfile",
                        "file_path": "ec2/deploy.json",
                        "prancer_unique_id": "e9e6c70a-07fc-4870-83b8-0565f75d83b8"
                    }
                ]
            }
        },
        "Ec2Instance": {
            "Type": "AWS::EC2::Instance",
            "Properties": {
                "KeyName": {
                    "Ref": "KeyPair"
                },
                "ImageId": "ami-3b355a52",
                "IamInstanceProfile": {
                    "Arn": {
                        "Fn::GetAtt": [
                            "MyIamInstanceProfile",
                            "Arn"
                        ]
                    }
                },
                "Tags": [
                    {
                        "created_timestamp": 1646301344,
                        "last_modified_timestamp": 1646301466,
                        "resource_name": "Ec2Instance",
                        "resource_type": "AWS::EC2::Instance",
                        "file_path": "ec2/deploy.json",
                        "prancer_unique_id": "b9d28b9b-d4bf-40ba-a1da-91249f9ba9e0"
                    }
                ]
            }
        }
    },
    "Outputs": {
        "InstanceId": {
            "Description": "The InstanceId of the newly created EC2 instance",
            "Value": {
                "Ref": "Ec2Instance"
            }
        }
    },
    "AWSTemplateFormatVersion": "2010-09-09"
}